<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn Content Studio v2.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 800px;
            min-height: 600px;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* Settings Button */
        .settings-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #f5f5f5;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            transition: all 0.2s;
            z-index: 100;
        }

        .settings-btn:hover {
            background: #e0e0e0;
            transform: rotate(45deg);
        }

        .settings-btn.hidden {
            display: none;
        }

        /* Settings Panel */
        .settings-panel {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: white;
            border-radius: 20px;
            padding: 40px;
            overflow-y: auto;
            z-index: 99;
            display: none;
        }

        .settings-panel.visible {
            display: block;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
        }

        .settings-title {
            font-size: 28px;
            font-weight: 600;
        }

        .save-settings-btn {
            padding: 12px 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .save-settings-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        /* Home Screen */
        .home-screen {
            padding: 60px 40px;
            display: flex;
            flex-direction: column;
            gap: 30px;
        }

        .home-screen.hidden {
            display: none;
        }

        .logo {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
            margin-bottom: 10px;
        }

        .tagline {
            text-align: center;
            color: #666;
            font-size: 16px;
            margin-bottom: 20px;
        }

        /* About You Section */
        .about-section {
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 14px;
            font-weight: 600;
            color: #333;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .about-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            min-height: 80px;
            transition: all 0.2s;
        }

        .about-input:focus {
            outline: none;
            border-color: #667eea;
        }

        /* Tone Sliders */
        .tone-sliders {
            display: grid;
            gap: 25px;
            margin-bottom: 20px;
        }

        .slider-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #666;
            font-weight: 500;
        }

        .slider-container {
            position: relative;
            height: 6px;
            background: #e0e0e0;
            border-radius: 3px;
        }

        .slider {
            position: absolute;
            width: 100%;
            height: 6px;
            opacity: 0;
            cursor: pointer;
            z-index: 2;
        }

        .slider-track {
            position: absolute;
            height: 6px;
            background: linear-gradient(to right, #667eea, #764ba2);
            border-radius: 3px;
            width: 50%;
            left: 0;
        }

        .slider-thumb {
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #667eea;
            border-radius: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            left: 50%;
            pointer-events: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        /* Word Length Slider */
        .word-length-section {
            margin-bottom: 20px;
        }

        .dual-slider-container {
            position: relative;
            height: 50px;
            margin-top: 25px;
            padding: 0 12px;
        }

        .dual-slider-track {
            position: absolute;
            top: 23px;
            left: 12px;
            right: 12px;
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
        }

        .dual-slider-range {
            position: absolute;
            top: 23px;
            height: 4px;
            background: linear-gradient(to right, #667eea, #764ba2);
            border-radius: 2px;
            pointer-events: none;
        }

        .dual-slider-input {
            position: absolute;
            top: 15px;
            left: 0;
            width: 100%;
            height: 20px;
            opacity: 0;
            cursor: pointer;
            z-index: 5;
        }

        .dual-thumb {
            position: absolute;
            width: 20px;
            height: 20px;
            background: white;
            border: 3px solid #667eea;
            border-radius: 50%;
            top: 15px;
            cursor: grab;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
            z-index: 4;
            pointer-events: none;
        }

        .dual-thumb:active {
            cursor: grabbing;
        }

        .dual-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 12px;
            color: #666;
        }

        .word-count-display {
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
            font-weight: 600;
            color: #667eea;
        }

        /* Source Material */
        .source-input {
            width: 100%;
            min-height: 150px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 15px;
            font-family: inherit;
            resize: vertical;
            transition: all 0.2s;
        }

        .source-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .generate-btn {
            padding: 16px 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .generate-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Generator View */
        .generator-view {
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .generator-view.visible {
            display: flex;
        }

        .generator-header {
            padding: 30px 40px;
            border-bottom: 2px solid #f0f0f0;
        }

        .generator-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .generator-subtitle {
            color: #666;
            font-size: 14px;
        }

        .post-display {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
            position: relative;
        }

        .post-content {
            background: #f9f9f9;
            padding: 30px;
            border-radius: 12px;
            font-size: 15px;
            line-height: 1.6;
            white-space: pre-wrap;
            min-height: 200px;
            cursor: text;
            position: relative;
        }

        .post-content:hover {
            background: #f5f5f5;
        }

        .post-content.editing {
            background: white;
            border: 2px solid #667eea;
            cursor: auto;
        }

        .edit-mode-indicator {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #667eea;
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
            display: none;
        }

        .post-content.editing .edit-mode-indicator {
            display: block;
        }

        .revert-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 8px 16px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            display: none;
            transition: all 0.2s;
        }

        .revert-btn.visible {
            display: block;
        }

        .revert-btn:hover {
            background: #ff5252;
            transform: translateY(-1px);
        }

        .loading-indicator {
            text-align: center;
            color: #999;
            font-size: 14px;
            padding: 40px;
        }

        .generator-actions {
            padding: 20px 40px;
            display: flex;
            gap: 15px;
            border-top: 2px solid #f0f0f0;
        }

        .action-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .like-btn {
            background: #4caf50;
            color: white;
        }

        .like-btn:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .comment-btn {
            background: #2196f3;
            color: white;
        }

        .comment-btn:hover {
            background: #1976d2;
            transform: translateY(-2px);
        }

        .erase-btn {
            background: #ff9800;
            color: white;
        }

        .erase-btn:hover {
            background: #f57c00;
            transform: translateY(-2px);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Comment Modal */
        .comment-modal {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .comment-modal.visible {
            display: flex;
        }

        .comment-box {
            background: white;
            padding: 30px;
            border-radius: 16px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .comment-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .comment-input {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 15px;
        }

        .comment-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .comment-actions {
            display: flex;
            gap: 10px;
        }

        .submit-comment-btn, .cancel-comment-btn {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .submit-comment-btn {
            background: #2196f3;
            color: white;
        }

        .submit-comment-btn:hover {
            background: #1976d2;
        }

        .cancel-comment-btn {
            background: #f5f5f5;
            color: #666;
        }

        .cancel-comment-btn:hover {
            background: #e0e0e0;
        }

        /* Navigation */
        .bottom-nav {
            display: flex;
            border-top: 2px solid #f0f0f0;
            background: white;
            border-radius: 0 0 20px 20px;
        }

        .nav-item {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            background: none;
            font-size: 14px;
            font-weight: 600;
            color: #666;
        }

        .nav-item:hover {
            background: #f9f9f9;
            color: #667eea;
        }

        .nav-item.active {
            color: #667eea;
            border-top: 3px solid #667eea;
        }

        /* Drafts & Archive */
        .content-list {
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .content-list.visible {
            display: flex;
        }

        .list-header {
            padding: 30px 40px;
            border-bottom: 2px solid #f0f0f0;
        }

        .list-title {
            font-size: 24px;
            font-weight: 600;
        }

        .list-items {
            flex: 1;
            overflow-y: auto;
            padding: 20px 40px;
        }

        .list-item {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .list-item:hover {
            background: #f0f0f0;
            transform: translateX(5px);
        }

        .item-preview {
            font-size: 14px;
            line-height: 1.5;
            color: #333;
            margin-bottom: 10px;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .item-meta {
            font-size: 12px;
            color: #999;
        }

        .empty-state {
            text-align: center;
            padding: 60px 40px;
            color: #999;
        }

        /* Editor */
        .editor-view {
            display: none;
            flex-direction: column;
            height: 100%;
        }

        .editor-view.visible {
            display: flex;
        }

        .editor-header {
            padding: 30px 40px;
            border-bottom: 2px solid #f0f0f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .back-btn {
            padding: 10px 20px;
            background: #f5f5f5;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            color: #666;
            transition: all 0.2s;
        }

        .back-btn:hover {
            background: #e0e0e0;
        }

        .editor-content {
            flex: 1;
            padding: 40px;
            overflow-y: auto;
        }

        .editor-textarea {
            width: 100%;
            min-height: 300px;
            padding: 20px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 15px;
            font-family: inherit;
            line-height: 1.6;
            resize: vertical;
        }

        .editor-textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .version-controls {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            align-items: center;
        }

        .version-btn {
            padding: 10px 20px;
            background: #f5f5f5;
            border: none;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .version-btn:hover:not(:disabled) {
            background: #e0e0e0;
        }

        .version-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .version-info {
            flex: 1;
            text-align: center;
            font-size: 14px;
            color: #666;
        }

        .editor-actions {
            padding: 20px 40px;
            border-top: 2px solid #f0f0f0;
            display: flex;
            gap: 15px;
        }

        .finalize-btn {
            flex: 1;
            padding: 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .finalize-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
        }

        .delete-btn {
            padding: 16px 30px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }

        .delete-btn:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }

        @media (max-width: 768px) {
            .container {
                border-radius: 0;
                min-height: 100vh;
            }

            .home-screen, .post-display, .list-items, .editor-content {
                padding: 20px;
            }

            .generator-header, .list-header, .editor-header {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Settings Button -->
        <button class="settings-btn" onclick="toggleSettings()">‚öôÔ∏è</button>

        <!-- Settings Panel -->
        <div class="settings-panel" id="settingsPanel">
            <div class="settings-header">
                <div class="settings-title">Settings</div>
                <button class="save-settings-btn" onclick="saveSettings()">Save Settings</button>
            </div>

            <div class="about-section">
                <div class="section-title">About You</div>
                <textarea class="about-input" id="settingsAbout" placeholder="Add context about yourself (background, expertise, positioning, etc.)"></textarea>
            </div>

            <div class="section-title">Tone of Voice</div>
            <div class="tone-sliders" id="settingsToneSliders"></div>

            <div class="word-length-section">
                <div class="section-title">Word Length</div>
                <div class="dual-slider-container" id="settingsWordLengthContainer">
                    <div class="dual-slider-track"></div>
                    <div class="dual-slider-range" id="settingsWordRange"></div>
                    <input type="range" min="20" max="500" value="100" class="dual-slider-input" id="settingsMinSlider">
                    <input type="range" min="20" max="500" value="300" class="dual-slider-input" id="settingsMaxSlider">
                    <div class="dual-thumb" id="settingsMinThumb"></div>
                    <div class="dual-thumb" id="settingsMaxThumb"></div>
                </div>
                <div class="dual-labels">
                    <span>20 words</span>
                    <span>500 words</span>
                </div>
                <div class="word-count-display" id="settingsWordDisplay">100-300 words</div>
            </div>
        </div>

        <!-- Home Screen -->
        <div class="home-screen" id="homeScreen">
            <div class="logo">LinkedIn Content Studio</div>
            <div class="tagline">Transform ideas into engaging posts</div>

            <div class="about-section">
                <div class="section-title">About You</div>
                <textarea class="about-input" id="aboutYou" placeholder="Add context about yourself: your background, expertise, positioning, industry, or any relevant information that should inform the content style..."></textarea>
            </div>

            <div class="section-title">Tone of Voice</div>
            <div class="tone-sliders" id="toneSliders"></div>

            <div class="word-length-section">
                <div class="section-title">Word Length</div>
                <div class="dual-slider-container" id="wordLengthContainer">
                    <div class="dual-slider-track"></div>
                    <div class="dual-slider-range" id="wordRange"></div>
                    <input type="range" min="20" max="500" value="100" class="dual-slider-input" id="minSlider">
                    <input type="range" min="20" max="500" value="300" class="dual-slider-input" id="maxSlider">
                    <div class="dual-thumb" id="minThumb"></div>
                    <div class="dual-thumb" id="maxThumb"></div>
                </div>
                <div class="dual-labels">
                    <span>20 words</span>
                    <span>500 words</span>
                </div>
                <div class="word-count-display" id="wordDisplay">100-300 words</div>
            </div>

            <div class="section-title">Source Material</div>
            <textarea class="source-input" id="sourceMaterial" placeholder="Paste your ideas, notes, or any content you want to transform into a LinkedIn post..."></textarea>

            <button class="generate-btn" onclick="startGeneration()">Generate Posts</button>
        </div>

        <!-- Generator View -->
        <div class="generator-view" id="generatorView">
            <div class="generator-header">
                <div class="generator-title">Review & Refine</div>
                <div class="generator-subtitle">Like it, improve it, or generate new</div>
            </div>

            <div class="post-display">
                <div class="post-content" id="postContent" contenteditable="false" onclick="enableEditing()">
                    <div class="edit-mode-indicator">Editing</div>
                    <div class="loading-indicator">Generating your first post...</div>
                </div>
                <button class="revert-btn" id="revertBtn" onclick="revertToOriginal()">Revert to Original</button>
            </div>

            <div class="generator-actions">
                <button class="action-btn like-btn" onclick="likePost()">
                    <span>üëç</span>
                    <span>Save to Drafts</span>
                </button>
                <button class="action-btn comment-btn" onclick="openCommentModal()">
                    <span>üí¨</span>
                    <span>Improve</span>
                </button>
                <button class="action-btn erase-btn" onclick="erasePost()">
                    <span>üîÑ</span>
                    <span>Generate New</span>
                </button>
            </div>
        </div>

        <!-- Comment Modal -->
        <div class="comment-modal" id="commentModal">
            <div class="comment-box">
                <div class="comment-title">How should I improve this?</div>
                <textarea class="comment-input" id="commentInput" placeholder="E.g., Make it more casual, focus on the financial benefits, add a personal story..."></textarea>
                <div class="comment-actions">
                    <button class="cancel-comment-btn" onclick="closeCommentModal()">Cancel</button>
                    <button class="submit-comment-btn" onclick="submitComment()">Improve Post</button>
                </div>
            </div>
        </div>

        <!-- Drafts View -->
        <div class="content-list" id="draftsView">
            <div class="list-header">
                <div class="list-title">Drafts</div>
            </div>
            <div class="list-items" id="draftsList">
                <div class="empty-state">No drafts yet. Like posts in the generator to save them here.</div>
            </div>
        </div>

        <!-- Archive View -->
        <div class="content-list" id="archiveView">
            <div class="list-header">
                <div class="list-title">Archive</div>
            </div>
            <div class="list-items" id="archiveList">
                <div class="empty-state">No archived posts yet. Finalize drafts to archive them.</div>
            </div>
        </div>

        <!-- Editor View -->
        <div class="editor-view" id="editorView">
            <div class="editor-header">
                <button class="back-btn" onclick="backToDrafts()">‚Üê Back to Drafts</button>
            </div>
            <div class="editor-content">
                <textarea class="editor-textarea" id="editorTextarea"></textarea>
                <div class="version-controls">
                    <button class="version-btn" onclick="previousVersion()" id="prevVersionBtn">‚Üê Previous</button>
                    <div class="version-info" id="versionInfo">Version 1 of 1</div>
                    <button class="version-btn" onclick="nextVersion()" id="nextVersionBtn">Next ‚Üí</button>
                </div>
            </div>
            <div class="editor-actions">
                <button class="delete-btn" onclick="deleteDraft()">Delete</button>
                <button class="finalize-btn" onclick="finalizeDraft()">Finalize & Archive</button>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <button class="nav-item" onclick="showView('generator')">Generator</button>
            <button class="nav-item" onclick="showView('drafts')">Drafts</button>
            <button class="nav-item" onclick="showView('archive')">Archive</button>
        </div>
    </div>

    <script>
        // State Management
        const state = {
            aboutYou: '',
            toneSettings: {
                seriousness: 2, // 0=serious, 4=humor
                formality: 2, // 0=formal, 4=casual
                focus: 2, // 0=company, 4=personal
                length: 2, // 0=elaborate, 4=concise
                language: 2, // 0=formal, 4=spoken
                transparency: 2, // 0=secrecy, 4=transparency
                swearing: 0, // 0=no swearing, 4=swearing
                emojis: 2 // 0=no emojis, 4=using emojis
            },
            wordLength: { min: 100, max: 300 },
            sourceMaterial: '',
            currentPost: null,
            originalPost: null,
            hasUserEdits: false,
            reservePost: null,
            isGenerating: false,
            drafts: [],
            archive: [],
            currentDraftId: null
        };

        // Tone slider configuration
        const toneSliders = [
            { key: 'seriousness', left: 'Serious', right: 'Humor' },
            { key: 'formality', left: 'Formal', right: 'Casual' },
            { key: 'focus', left: 'Company Focus', right: 'Personal Focus' },
            { key: 'length', left: 'Elaborate', right: 'Concise' },
            { key: 'language', left: 'Formal Language', right: 'Spoken Language' },
            { key: 'transparency', left: 'Secrecy', right: 'Transparency' },
            { key: 'swearing', left: 'No Swearing', right: 'Swearing' },
            { key: 'emojis', left: 'No Emojis', right: 'Using Emojis' }
        ];

        // Generic Content Principles (no personal info)
        const contentPrinciples = `
# LinkedIn Content Principles

## Voice & Style
- Mix expertise with personal storytelling when relevant
- Use source material to maintain authentic voice
- Sentences should vary in length (some short, some longer)
- Text should flow smoothly and naturally, not choppy or mechanical
- Professional but authentic‚Äîno corporate jargon or buzzwords
- Opinionated but not arrogant

## What NOT to Use
- ‚ùå "It's not X, it's Y" constructions
- ‚ùå Long dashes (‚Äî)
- ‚ùå Bold or italics
- ‚ùå Made-up analogies or stories (only use source material)
- ‚ùå Corporate speak or generic marketing advice
- ‚ùå Forced engagement questions

## Formatting
- Paragraphs separated by line breaks for readability
- Bullet points allowed when natural for the topic
- First line must hook in feed view
- Short paragraphs (2-3 lines max)
- Generous line breaks

## Ending
- Questions at the end are optional
- If included, must feel natural and never forced
- Not every post needs a closing question

## Core Approach
- Specific over general
- Show work, share real examples
- Include specific numbers/examples when available
- Natural engagement when appropriate
- Tie back to professional value proposition
`;

        // Initialize
        function init() {
            renderToneSliders();
            setupDualSlider('minSlider', 'maxSlider', 'wordRange', 'minThumb', 'maxThumb', 'wordDisplay');
            setupDualSlider('settingsMinSlider', 'settingsMaxSlider', 'settingsWordRange', 'settingsMinThumb', 'settingsMaxThumb', 'settingsWordDisplay');
        }

        // Render tone sliders
        function renderToneSliders() {
            const containers = ['toneSliders', 'settingsToneSliders'];
            containers.forEach(containerId => {
                const container = document.getElementById(containerId);
                container.innerHTML = toneSliders.map(slider => `
                    <div class="slider-group">
                        <div class="slider-labels">
                            <span>${slider.left}</span>
                            <span>${slider.right}</span>
                        </div>
                        <div class="slider-container">
                            <input type="range" min="0" max="4" value="${state.toneSettings[slider.key]}" 
                                   class="slider" id="${containerId}-${slider.key}"
                                   oninput="updateToneSlider('${slider.key}', this.value, '${containerId}')">
                            <div class="slider-track" id="${containerId}-${slider.key}-track"></div>
                            <div class="slider-thumb" id="${containerId}-${slider.key}-thumb"></div>
                        </div>
                    </div>
                `).join('');

                // Initialize slider positions
                toneSliders.forEach(slider => {
                    updateSliderVisuals(slider.key, state.toneSettings[slider.key], containerId);
                });
            });
        }

        // Update tone slider
        function updateToneSlider(key, value, containerId) {
            state.toneSettings[key] = parseInt(value);
            updateSliderVisuals(key, value, containerId);
            
            // Sync between home and settings
            if (containerId === 'toneSliders') {
                document.getElementById('settingsToneSliders-' + key).value = value;
                updateSliderVisuals(key, value, 'settingsToneSliders');
            } else {
                document.getElementById('toneSliders-' + key).value = value;
                updateSliderVisuals(key, value, 'toneSliders');
            }
        }

        // Update slider visuals
        function updateSliderVisuals(key, value, containerId) {
            const percentage = (value / 4) * 100;
            const track = document.getElementById(`${containerId}-${key}-track`);
            const thumb = document.getElementById(`${containerId}-${key}-thumb`);
            
            if (track && thumb) {
                track.style.width = percentage + '%';
                thumb.style.left = percentage + '%';
            }
        }

        // Setup dual slider for word length
        function setupDualSlider(minId, maxId, rangeId, minThumbId, maxThumbId, displayId) {
            const minSlider = document.getElementById(minId);
            const maxSlider = document.getElementById(maxId);
            const range = document.getElementById(rangeId);
            const minThumb = document.getElementById(minThumbId);
            const maxThumb = document.getElementById(maxThumbId);
            const display = document.getElementById(displayId);

            if (!minSlider || !maxSlider) return;

            function updateSlider() {
                let minVal = parseInt(minSlider.value);
                let maxVal = parseInt(maxSlider.value);

                // Ensure minimum gap of 20 words
                if (minVal > maxVal - 20) {
                    minVal = maxVal - 20;
                    minSlider.value = minVal;
                }
                if (maxVal < minVal + 20) {
                    maxVal = minVal + 20;
                    maxSlider.value = maxVal;
                }

                // Calculate percentages (0-100%)
                const minPercent = ((minVal - 20) / 480) * 100;
                const maxPercent = ((maxVal - 20) / 480) * 100;

                // Update range bar
                range.style.left = minPercent + '%';
                range.style.width = (maxPercent - minPercent) + '%';

                // Update thumbs (centered on their position)
                minThumb.style.left = `calc(${minPercent}% - 10px)`;
                maxThumb.style.left = `calc(${maxPercent}% - 10px)`;

                // Update display
                display.textContent = `${minVal}-${maxVal} words`;

                // Update state
                state.wordLength.min = minVal;
                state.wordLength.max = maxVal;

                // Sync between home and settings
                syncWordLengthSliders(minId, minVal, maxVal);
            }

            minSlider.addEventListener('input', updateSlider);
            maxSlider.addEventListener('input', updateSlider);

            // Initial update
            updateSlider();
        }

        // Sync word length between home and settings
        function syncWordLengthSliders(sourceId, minVal, maxVal) {
            let targetMinId, targetMaxId, targetRangeId, targetMinThumbId, targetMaxThumbId, targetDisplayId;
            
            if (sourceId === 'minSlider') {
                // Syncing from home to settings
                targetMinId = 'settingsMinSlider';
                targetMaxId = 'settingsMaxSlider';
                targetRangeId = 'settingsWordRange';
                targetMinThumbId = 'settingsMinThumb';
                targetMaxThumbId = 'settingsMaxThumb';
                targetDisplayId = 'settingsWordDisplay';
            } else if (sourceId === 'settingsMinSlider') {
                // Syncing from settings to home
                targetMinId = 'minSlider';
                targetMaxId = 'maxSlider';
                targetRangeId = 'wordRange';
                targetMinThumbId = 'minThumb';
                targetMaxThumbId = 'maxThumb';
                targetDisplayId = 'wordDisplay';
            } else {
                return; // No syncing needed
            }

            const targetMin = document.getElementById(targetMinId);
            const targetMax = document.getElementById(targetMaxId);
            const targetRange = document.getElementById(targetRangeId);
            const targetMinThumb = document.getElementById(targetMinThumbId);
            const targetMaxThumb = document.getElementById(targetMaxThumbId);
            const targetDisplay = document.getElementById(targetDisplayId);

            if (targetMin && targetMax && targetRange && targetMinThumb && targetMaxThumb && targetDisplay) {
                targetMin.value = minVal;
                targetMax.value = maxVal;

                const minPercent = ((minVal - 20) / 480) * 100;
                const maxPercent = ((maxVal - 20) / 480) * 100;

                targetRange.style.left = minPercent + '%';
                targetRange.style.width = (maxPercent - minPercent) + '%';
                targetMinThumb.style.left = `calc(${minPercent}% - 10px)`;
                targetMaxThumb.style.left = `calc(${maxPercent}% - 10px)`;
                targetDisplay.textContent = `${minVal}-${maxVal} words`;
            }
        }

        // Settings panel
        function toggleSettings() {
            const panel = document.getElementById('settingsPanel');
            if (panel.classList.contains('visible')) {
                panel.classList.remove('visible');
            } else {
                // Load current state into settings
                document.getElementById('settingsAbout').value = state.aboutYou;
                panel.classList.add('visible');
            }
        }

        function saveSettings() {
            // Save settings from panel to state
            state.aboutYou = document.getElementById('settingsAbout').value;
            document.getElementById('aboutYou').value = state.aboutYou;
            
            // Close panel
            document.getElementById('settingsPanel').classList.remove('visible');
        }

        // Start generation
        async function startGeneration() {
            state.aboutYou = document.getElementById('aboutYou').value.trim();
            state.sourceMaterial = document.getElementById('sourceMaterial').value.trim();

            if (!state.aboutYou) {
                alert('Please add information about yourself in the "About You" section.');
                return;
            }

            if (!state.sourceMaterial) {
                alert('Please enter some source material to transform into a post.');
                return;
            }

            // Hide home screen, show generator
            document.getElementById('homeScreen').classList.add('hidden');
            document.getElementById('generatorView').classList.add('visible');
            document.querySelector('.settings-btn').classList.remove('hidden');

            // Generate first post
            await generateNewPost();
        }

        // Generate new post
        async function generateNewPost() {
            if (state.isGenerating) return;

            state.isGenerating = true;
            const postContent = document.getElementById('postContent');
            postContent.innerHTML = '<div class="loading-indicator">Generating post...</div>';
            disableActions(true);

            try {
                const prompt = buildPrompt(state.sourceMaterial, null);
                const content = await callClaudeAPI(prompt);
                
                state.currentPost = content;
                state.originalPost = content;
                state.hasUserEdits = false;
                
                displayPost(content);
                disableActions(false);

                // Generate reserve post in background
                generateReservePost();
            } catch (error) {
                console.error('Generation error:', error);
                postContent.innerHTML = '<div class="loading-indicator">Error generating post. Please try again.</div>';
                disableActions(false);
            }

            state.isGenerating = false;
        }

        // Generate reserve post in background
        async function generateReservePost() {
            try {
                const prompt = buildPrompt(state.sourceMaterial, state.currentPost);
                const content = await callClaudeAPI(prompt);
                state.reservePost = content;
            } catch (error) {
                console.error('Reserve generation error:', error);
            }
        }

        // Build prompt for API
        function buildPrompt(sourceMaterial, previousPost) {
            const toneDescription = buildToneDescription();
            const wordRange = `${state.wordLength.min}-${state.wordLength.max}`;
            
            let prompt = `You are a LinkedIn content creator.

ABOUT THE AUTHOR:
${state.aboutYou}

SOURCE MATERIAL:
${sourceMaterial}

CONTENT PRINCIPLES:
${contentPrinciples}

TONE OF VOICE:
${toneDescription}

REQUIREMENTS:
- Create ONE engaging LinkedIn post
- Word count: ${wordRange} words
- Follow all content principles above
- Match the tone of voice settings
- Use the source material as the basis
- Be specific, show examples when possible
${previousPost ? '\n- Create a DIFFERENT angle/approach than the previous post\n- Vary structure and style significantly' : ''}

${previousPost ? `\nPREVIOUS POST (create something DIFFERENT):\n${previousPost}` : ''}

OUTPUT ONLY THE POST CONTENT. Do not include any preamble, explanation, or meta-commentary.`;

            return prompt;
        }

        // Build tone description from sliders
        function buildToneDescription() {
            const levels = ['Very', 'Somewhat', 'Neutral', 'Somewhat', 'Very'];
            const descriptions = [];

            toneSliders.forEach(slider => {
                const value = state.toneSettings[slider.key];
                const level = levels[value];
                
                if (value < 2) {
                    descriptions.push(`${level} ${slider.left.toLowerCase()}`);
                } else if (value > 2) {
                    descriptions.push(`${level} ${slider.right.toLowerCase()}`);
                }
            });

            return descriptions.length > 0 ? descriptions.join(', ') : 'Neutral tone across all dimensions';
        }

        // Call Claude API
        async function callClaudeAPI(prompt) {
            const response = await fetch("https://api.anthropic.com/v1/messages", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({
                    model: "claude-3-7-sonnet-20250219",
                    max_tokens: 1500,
                    messages: [
                        { role: "user", content: prompt }
                    ]
                })
            });

            if (!response.ok) {
                throw new Error(`API request failed: ${response.status}`);
            }

            const data = await response.json();
            return data.content[0].text.trim();
        }

        // Display post
        function displayPost(content) {
            const postContent = document.getElementById('postContent');
            postContent.textContent = content;
            postContent.contentEditable = 'false';
            postContent.classList.remove('editing');
            document.getElementById('revertBtn').classList.remove('visible');
        }

        // Enable editing in generator
        function enableEditing() {
            const postContent = document.getElementById('postContent');
            if (!postContent.classList.contains('editing')) {
                postContent.contentEditable = 'true';
                postContent.classList.add('editing');
                postContent.focus();
                
                // Move cursor to end
                const range = document.createRange();
                const sel = window.getSelection();
                range.selectNodeContents(postContent);
                range.collapse(false);
                sel.removeAllRanges();
                sel.addRange(range);
            }
        }

        // Monitor for user edits
        document.addEventListener('DOMContentLoaded', () => {
            const postContent = document.getElementById('postContent');
            postContent.addEventListener('input', () => {
                if (postContent.classList.contains('editing')) {
                    const currentContent = postContent.textContent;
                    if (currentContent !== state.originalPost) {
                        state.hasUserEdits = true;
                        state.currentPost = currentContent;
                        document.getElementById('revertBtn').classList.add('visible');
                    } else {
                        state.hasUserEdits = false;
                        document.getElementById('revertBtn').classList.remove('visible');
                    }
                }
            });
        });

        // Revert to original
        function revertToOriginal() {
            state.currentPost = state.originalPost;
            state.hasUserEdits = false;
            displayPost(state.originalPost);
        }

        // Action buttons
        function disableActions(disabled) {
            document.querySelectorAll('.generator-actions .action-btn').forEach(btn => {
                btn.disabled = disabled;
            });
        }

        // Like post
        async function likePost() {
            const draft = {
                id: Date.now(),
                content: state.currentPost,
                versions: [state.currentPost],
                versionIndex: 0,
                timestamp: new Date().toISOString()
            };

            state.drafts.push(draft);
            updateDraftsList();

            // Use reserve post if available, otherwise generate new
            if (state.reservePost) {
                state.currentPost = state.reservePost;
                state.originalPost = state.reservePost;
                state.hasUserEdits = false;
                state.reservePost = null;
                
                displayPost(state.currentPost);
                
                // Generate new reserve
                generateReservePost();
            } else {
                await generateNewPost();
            }
        }

        // Comment modal
        function openCommentModal() {
            document.getElementById('commentModal').classList.add('visible');
            document.getElementById('commentInput').value = '';
            document.getElementById('commentInput').focus();
        }

        function closeCommentModal() {
            document.getElementById('commentModal').classList.remove('visible');
        }

        // Submit comment
        async function submitComment() {
            const feedback = document.getElementById('commentInput').value.trim();
            if (!feedback) return;

            closeCommentModal();

            const postContent = document.getElementById('postContent');
            postContent.innerHTML = '<div class="loading-indicator">Improving post based on your feedback...</div>';
            disableActions(true);

            try {
                const prompt = `You are revising a LinkedIn post based on user feedback.

ORIGINAL POST:
${state.currentPost}

USER FEEDBACK:
${feedback}

CONTENT PRINCIPLES:
${contentPrinciples}

TONE OF VOICE:
${buildToneDescription()}

REQUIREMENTS:
- Revise the post incorporating the user's feedback
- Word count: ${state.wordLength.min}-${state.wordLength.max} words
- Maintain the core message but adjust as requested
- Follow all content principles

OUTPUT ONLY THE REVISED POST. No preamble or explanation.`;

                const content = await callClaudeAPI(prompt);
                
                state.currentPost = content;
                state.originalPost = content;
                state.hasUserEdits = false;
                
                displayPost(content);
                disableActions(false);

                // Generate new reserve
                generateReservePost();
            } catch (error) {
                console.error('Revision error:', error);
                postContent.innerHTML = '<div class="loading-indicator">Error improving post. Please try again.</div>';
                disableActions(false);
            }
        }

        // Erase post
        async function erasePost() {
            // Use reserve if available
            if (state.reservePost) {
                state.currentPost = state.reservePost;
                state.originalPost = state.reservePost;
                state.hasUserEdits = false;
                state.reservePost = null;
                
                displayPost(state.currentPost);
                
                // Generate new reserve
                generateReservePost();
            } else {
                await generateNewPost();
            }
        }

        // Update navigation counts
        function updateNavCounts() {
            const navItems = document.querySelectorAll('.nav-item');
            navItems[1].textContent = `Drafts (${state.drafts.length})`;
            navItems[2].textContent = `Archive (${state.archive.length})`;
        }
        function updateDraftsList() {
            const list = document.getElementById('draftsList');
            
            if (state.drafts.length === 0) {
                list.innerHTML = '<div class="empty-state">No drafts yet. Like posts in the generator to save them here.</div>';
            } else {
                list.innerHTML = state.drafts.map(draft => {
                    const preview = draft.content.substring(0, 150) + (draft.content.length > 150 ? '...' : '');
                    const date = new Date(draft.timestamp).toLocaleDateString();
                    
                    return `
                        <div class="list-item" onclick="openDraft(${draft.id})">
                            <div class="item-preview">${preview}</div>
                            <div class="item-meta">Saved ${date}</div>
                        </div>
                    `;
                }).join('');
            }
            
            updateNavCounts();
        }

        // Update archive list
        function updateArchiveList() {
            const list = document.getElementById('archiveList');
            
            if (state.archive.length === 0) {
                list.innerHTML = '<div class="empty-state">No archived posts yet. Finalize drafts to archive them.</div>';
            } else {
                list.innerHTML = state.archive.map(post => {
                    const preview = post.content.substring(0, 150) + (post.content.length > 150 ? '...' : '');
                    const date = new Date(post.timestamp).toLocaleDateString();
                    
                    return `
                        <div class="list-item" onclick="viewArchive(${post.id})">
                            <div class="item-preview">${preview}</div>
                            <div class="item-meta">Archived ${date}</div>
                        </div>
                    `;
                }).join('');
            }
            
            updateNavCounts();
        }

        // View archived post (read-only)
        function viewArchive(id) {
            const post = state.archive.find(p => p.id === id);
            if (!post) return;

            // Show in editor as read-only
            const textarea = document.getElementById('editorTextarea');
            textarea.value = post.content;
            textarea.readOnly = true;
            textarea.style.background = '#f9f9f9';
            
            // Hide version controls and action buttons for archive view
            document.querySelector('.version-controls').style.display = 'none';
            document.querySelector('.editor-actions').style.display = 'none';
            
            // Change back button text
            document.querySelector('.back-btn').textContent = '‚Üê Back to Archive';
            document.querySelector('.back-btn').onclick = () => {
                textarea.readOnly = false;
                textarea.style.background = 'white';
                document.querySelector('.version-controls').style.display = 'flex';
                document.querySelector('.editor-actions').style.display = 'flex';
                document.querySelector('.back-btn').textContent = '‚Üê Back to Drafts';
                document.querySelector('.back-btn').onclick = backToDrafts;
                showView('archive');
            };
            
            showView('editor');
        }

        // Open draft in editor
        function openDraft(id) {
            const draft = state.drafts.find(d => d.id === id);
            if (!draft) return;

            state.currentDraftId = id;
            
            document.getElementById('editorTextarea').value = draft.content;
            updateVersionControls(draft);
            
            showView('editor');
        }

        // Update version controls
        function updateVersionControls(draft) {
            const info = document.getElementById('versionInfo');
            const prevBtn = document.getElementById('prevVersionBtn');
            const nextBtn = document.getElementById('nextVersionBtn');

            info.textContent = `Version ${draft.versionIndex + 1} of ${draft.versions.length}`;
            prevBtn.disabled = draft.versionIndex === 0;
            nextBtn.disabled = draft.versionIndex === draft.versions.length - 1;
        }

        // Version navigation
        function previousVersion() {
            const draft = state.drafts.find(d => d.id === state.currentDraftId);
            if (!draft || draft.versionIndex === 0) return;

            // Save current content
            draft.versions[draft.versionIndex] = document.getElementById('editorTextarea').value;
            
            draft.versionIndex--;
            document.getElementById('editorTextarea').value = draft.versions[draft.versionIndex];
            updateVersionControls(draft);
        }

        function nextVersion() {
            const draft = state.drafts.find(d => d.id === state.currentDraftId);
            if (!draft || draft.versionIndex === draft.versions.length - 1) return;

            // Save current content
            draft.versions[draft.versionIndex] = document.getElementById('editorTextarea').value;
            
            draft.versionIndex++;
            document.getElementById('editorTextarea').value = draft.versions[draft.versionIndex];
            updateVersionControls(draft);
        }

        // Editor textarea auto-save
        document.addEventListener('DOMContentLoaded', () => {
            const textarea = document.getElementById('editorTextarea');
            textarea.addEventListener('input', () => {
                const draft = state.drafts.find(d => d.id === state.currentDraftId);
                if (draft) {
                    draft.content = textarea.value;
                    draft.versions[draft.versionIndex] = textarea.value;
                }
            });
        });

        // Back to drafts
        function backToDrafts() {
            showView('drafts');
        }

        // Delete draft
        function deleteDraft() {
            if (!confirm('Are you sure you want to delete this draft?')) return;

            state.drafts = state.drafts.filter(d => d.id !== state.currentDraftId);
            updateDraftsList();
            showView('drafts');
        }

        // Finalize draft
        function finalizeDraft() {
            const draft = state.drafts.find(d => d.id === state.currentDraftId);
            if (!draft) return;

            // Add to archive
            state.archive.push({
                id: Date.now(),
                content: draft.content,
                timestamp: new Date().toISOString()
            });

            // Remove from drafts
            state.drafts = state.drafts.filter(d => d.id !== state.currentDraftId);
            
            updateDraftsList();
            updateArchiveList();
            showView('archive');
        }

        // View navigation
        function showView(view) {
            // Hide all views
            document.getElementById('homeScreen').classList.add('hidden');
            document.getElementById('generatorView').classList.remove('visible');
            document.getElementById('draftsView').classList.remove('visible');
            document.getElementById('archiveView').classList.remove('visible');
            document.getElementById('editorView').classList.remove('visible');

            // Remove active state from all nav items
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.remove('active');
            });

            // Show selected view
            switch(view) {
                case 'generator':
                    document.getElementById('generatorView').classList.add('visible');
                    document.querySelectorAll('.nav-item')[0].classList.add('active');
                    break;
                case 'drafts':
                    document.getElementById('draftsView').classList.add('visible');
                    document.querySelectorAll('.nav-item')[1].classList.add('active');
                    updateDraftsList();
                    break;
                case 'archive':
                    document.getElementById('archiveView').classList.add('visible');
                    document.querySelectorAll('.nav-item')[2].classList.add('active');
                    updateArchiveList();
                    break;
                case 'editor':
                    document.getElementById('editorView').classList.add('visible');
                    break;
            }
        }

        // Initialize on load
        init();
        updateNavCounts();
    </script>
</body>
</html>